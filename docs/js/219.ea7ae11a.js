"use strict";(self["webpackChunkfe_useful_code"]=self["webpackChunkfe_useful_code"]||[]).push([[219],{49219:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"custom-page"},[t("div",{staticClass:"custom-search-bar"},[t("el-form",{ref:"formRef",attrs:{model:e.form,inline:!0}},[t("el-form-item",{attrs:{label:"金额范围",prop:"min"}},[t("el-input",{staticStyle:{width:"160px"},attrs:{type:"number",placeholder:"最小值",min:"0",clearable:""},model:{value:e.form.min,callback:function(t){e.$set(e.form,"min",t)},expression:"form.min"}})],1),t("el-form-item",{attrs:{prop:"max"}},[t("el-input",{staticStyle:{width:"160px"},attrs:{type:"number",placeholder:"最大值",max:"99999999999",clearable:""},model:{value:e.form.max,callback:function(t){e.$set(e.form,"max",t)},expression:"form.max"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onSearch}},[e._v("查询")])],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.onReset}},[e._v("重置")])],1),t("el-form-item",[t("el-upload",{ref:"upload",attrs:{action:"","auto-upload":!1,multiple:!0,"show-file-list":!1,"on-change":e.handleFileChange,accept:".xlsx,.xls"}},[t("el-button",{attrs:{type:"primary"}},[e._v("选择Excel文件")])],1)],1)],1)],1),t("div",{staticClass:"custom-content"},[e.tableData.length?t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"100%"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e._l(e.tableHeader,(function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e}})}))],2):e._e()],1)])},n=[],r=(o(24224),o(61121),o(37133),o(70560),o(87092)),a={name:"importExcelByMulti",data(){return{form:{min:"",max:"",time:[]},tableHeader:[],tableData:[]}},methods:{onSearch(){!this.form.min||this.form.max?this.form.min||!this.form.max?this.form.min&&this.form.max&&this.form.min>this.form.max?this.$message.warning("最小值不能大于最大值"):this.form.min!==this.form.max||this.$message.warning("最小值和最大值不能相等"):this.$message.warning("请输入最小值"):this.$message.warning("请输入最大值")},onReset(){this.$refs.formRef.resetFields()},async handleFileChange(e,t){this.tableHeader=[],this.tableData=[];for(const o of t){const e=o.raw||o;await this.readExcel(e)}},readExcel(e){return new Promise((t=>{const o=new FileReader;o.onload=e=>{const o=new Uint8Array(e.target.result),l=r.ij(o,{type:"array"}),n=l.SheetNames[0],a=l.Sheets[n];console.log("%c读取的sheet:","color: red; font-size: 1.4em; font-weight: bolder;"),console.log(a);let s=r.P6.sheet_to_json(a,{header:1});console.log("%c转换后的json:","color: blue; font-size: 1.4em; font-weight: bolder;"),console.log(s),console.log("%c最长的数组:","color: green; font-size: 1.4em; font-weight: bolder;");const i=this.findLongestArray(s);function c(e,t,o=["日期","货币","交易金额","余额","交易地方/地点","摘要","对方账户或户名"]){let l=e[0],n=t.map(((t,n)=>{console.log("---"),console.log("%c1.看看kw","font-weight: bolder;"),console.log(t);let r=l.findIndex((e=>e.includes(t)));return console.log("%c2.看看idx，关键字在第一行数据的索引值","color: red; font-weight: bolder;"),console.log(r),-1===r?(l.push(o[n]),console.log("%c3.表头补充数据后的数据","color: green; font-size: 1.5em; font-weight: bolcer;"),console.log(l),e.forEach((e=>e.push(""))),console.log(l.length-1),l.length-1):r}));return console.log("%clast看看 keywordIndex 是什么 => ","color: tomato; font-weight: bolder;"),console.log(n),e.map((e=>n.map((t=>e[t]))))}console.log(i);let m=["日期","币","金额","余额","地","摘要","对"],h=c(s,m);if(console.log("根据关键字排序后的json:",h),s=h,s.length){this.tableHeader.length||(this.tableHeader=["日期","货币","交易金额","余额","交易地方/地点","摘要","对方账户或户名"]);let e=s.slice(i.index);for(let t=1;t<e.length;t++){const o={};this.tableHeader.forEach(((l,n)=>{o[l]=e[t][n]||""})),this.tableData.push(o)}}t()},o.readAsArrayBuffer(e)}))},findLongestArray(e){let t=0,o=null,l=-1;for(let n=0;n<20;n++){const r=e[n];r&&r.length>t&&(t=r.length,o=r,l=n)}return{array:o,index:l}}}},s=a,i=o(1001),c=(0,i.Z)(s,l,n,!1,null,null,null),m=c.exports}}]);
//# sourceMappingURL=219.ea7ae11a.js.map