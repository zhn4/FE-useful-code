{"version":3,"file":"js/920.3224e41c.js","mappings":"wKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,QAAQ,CAACG,IAAI,QAAQD,YAAY,QAAQE,YAAY,CAAC,MAAQ,QAAQ,OAAS,QAAQ,WAAa,QAAQC,MAAM,CAAC,SAAW,GAAG,YAAc,MAAML,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,YAAY,CAACK,MAAM,CAAC,KAAO,SAAS,KAAO,SAASC,GAAG,CAAC,MAAQR,EAAIS,cAAc,CAACT,EAAIU,GAAG,WAAWR,EAAG,YAAY,CAACK,MAAM,CAAC,KAAO,UAAU,KAAO,SAASC,GAAG,CAAC,MAAQR,EAAIW,aAAa,CAACX,EAAIU,GAAG,YAAY,KAAKR,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,SAAS,CAACJ,EAAIU,GAAG,UAAUR,EAAG,MAAM,CAACE,YAAY,YAAY,CAACJ,EAAIY,GAAIZ,EAAIa,YAAY,SAASC,EAAKC,GAAO,MAAO,CAACb,EAAG,MAAM,CAACc,IAAID,EAAMX,YAAY,YAAY,CAACF,EAAG,MAAM,CAACF,EAAIU,GAAG,IAAIV,EAAIiB,GAAGF,EAAQ,GAAG,SAASb,EAAG,MAAM,CAACc,IAAID,EAAMX,YAAY,MAAMG,MAAM,CAAC,IAAMO,OAAU,KAAI,MAC72B,EACII,EAAkB,G,4BC8BtB,GACAC,IAAAA,GACA,OACAC,OAAA,KACAC,eAAA,KACAR,WAAA,GAEA,EACAS,QAAA,CACA,gBAAAX,GACA,IACA,KAAAS,aAAAG,UAAAC,aAAAC,aAAA,CAAAC,OAAA,IACA,KAAAC,MAAAD,MAAAE,UAAA,KAAAR,OACA,KAAAS,gBACA,OAAAC,GACA,KAAAC,SAAAC,MAAA,UACA,CACA,EACAvB,WAAAA,GACA,KAAAW,SACA,KAAAA,OAAAa,YAAAC,SAAAC,GAAAA,EAAAC,SACA,KAAAhB,OAAA,KACA,KAAAO,MAAAD,MAAAE,UAAA,MAEAS,cAAA,KAAAhB,eACA,EACAQ,cAAAA,GACA,KAAAR,eAAAiB,YAAA,KAAAC,eAAA,IACA,EACA,oBAAAA,GACA,MAAAb,EAAA,KAAAC,MAAAD,MAEAc,EAAAC,SAAAC,cAAA,UACAF,EAAAG,MAAAjB,EAAAkB,YAAA,IACAJ,EAAAK,OAAAnB,EAAAoB,aAAA,IACA,MAAAC,EAAAP,EAAAQ,WAAA,MACAD,EAAAE,UAAAvB,EAAA,IAAAc,EAAAG,MAAAH,EAAAK,QAGA,MAAAK,EAAAV,EAAAW,UAAA,aACA,KAAAtC,WAAAuC,KAAAF,GACAG,QAAAC,IAAA,KAAAzC,YAEA,MACAM,MAAA,KAAAoC,UACAC,IAAAA,UAAAN,EAAA,OACAG,QAAAC,IAAA,QAAAC,EACA,GAEAE,aAAAA,GACA,KAAAhD,aACA,GCnF6P,I,UCQzPiD,GAAY,OACd,EACA3D,EACAmB,GACA,EACA,KACA,WACA,MAIF,EAAewC,EAAiB,O","sources":["webpack://FE-useful-code/./src/views/testPage/index.vue","webpack://FE-useful-code/src/views/testPage/index.vue","webpack://FE-useful-code/./src/views/testPage/index.vue?ea2f","webpack://FE-useful-code/./src/views/testPage/index.vue?298d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"test-page\"},[_c('div',{staticClass:\"video-part\"},[_c('video',{ref:\"video\",staticClass:\"video\",staticStyle:{\"width\":\"640px\",\"height\":\"480px\",\"background\":\"#000\"},attrs:{\"autoplay\":\"\",\"playsinline\":\"\"}}),_c('div',{staticClass:\"video-controls\"},[_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"large\"},on:{\"click\":_vm.closeCamera}},[_vm._v(\"关闭摄像头\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"large\"},on:{\"click\":_vm.openCamera}},[_vm._v(\"打开摄像头\")])],1)]),_c('div',{staticClass:\"img-part\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"截图列表\")]),_c('div',{staticClass:\"img-list\"},[_vm._l((_vm.imgSrcList),function(item,index){return [_c('div',{key:index,staticClass:\"img-item\"},[_c('div',[_vm._v(\"第\"+_vm._s(index + 1)+\"张图片\")]),_c('img',{key:index,staticClass:\"img\",attrs:{\"src\":item}})])]})],2)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"test-page\">\n    <div class=\"video-part\">\n      <video\n        ref=\"video\"\n        autoplay\n        class=\"video\"\n        playsinline\n        style=\"width: 640px; height: 480px; background: #000\"\n      ></video>\n      <div class=\"video-controls\">\n        <el-button type=\"danger\" @click=\"closeCamera\" size=\"large\">关闭摄像头</el-button>\n        <el-button type=\"primary\" @click=\"openCamera\" size=\"large\">打开摄像头</el-button>\n      </div>\n    </div>\n    <div class=\"img-part\">\n      <div class=\"title\">截图列表</div>\n      <div class=\"img-list\">\n        <template v-for=\"(item, index) in imgSrcList\">\n          <div class=\"img-item\" :key=\"index\">\n            <div>第{{ index + 1 }}张图片</div>\n            <img :src=\"item\" :key=\"index\" class=\"img\" />\n          </div>\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Tesseract from 'tesseract.js'\n\nexport default {\n  data() {\n    return {\n      stream: null,\n      recognizeTimer: null,\n      imgSrcList: [],\n    }\n  },\n  methods: {\n    async openCamera() {\n      try {\n        this.stream = await navigator.mediaDevices.getUserMedia({ video: true })\n        this.$refs.video.srcObject = this.stream\n        this.startRecognize()\n      } catch (e) {\n        this.$message.error('无法打开摄像头')\n      }\n    },\n    closeCamera() {\n      if (this.stream) {\n        this.stream.getTracks().forEach(track => track.stop())\n        this.stream = null\n        this.$refs.video.srcObject = null\n      }\n      clearInterval(this.recognizeTimer)\n    },\n    startRecognize() {\n      this.recognizeTimer = setInterval(this.recognizeFrame, 2000)\n    },\n    async recognizeFrame() {\n      const video = this.$refs.video\n      // 创建离屏canvas\n      const canvas = document.createElement('canvas')\n      canvas.width = video.videoWidth || 640\n      canvas.height = video.videoHeight || 480\n      const ctx = canvas.getContext('2d')\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n      // 用img展示当前帧\n      // this.imgSrc = canvas.toDataURL('image/png');\n      const currentImg = canvas.toDataURL('image/png')\n      this.imgSrcList.push(currentImg)\n      console.log(this.imgSrcList)\n      // 识别内容\n      const {\n        data: { text },\n      } = await Tesseract.recognize(currentImg, 'eng')\n      console.log('识别内容:', text)\n    },\n  },\n  beforeDestroy() {\n    this.closeCamera()\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n.test-page {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n\n.video-part {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-right: 20px;\n\n  .video {\n    margin-bottom: 10px;\n  }\n}\n\n.img-part {\n  width: 240px;\n  height: 480px;\n  overflow: auto;\n  border: 1px solid #ccc;\n\n  .title {\n    font-size: 16px;\n    font-weight: bold;\n    position: sticky;\n    top: 0;\n    padding: 10px;\n    background: #f5f5f5;\n  }\n\n  .img-item {\n    padding: 10px;\n    border-bottom: 1px solid #eee;\n  }\n\n  .img {\n    width: 100%;\n    height: auto;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=f12b63f8&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=f12b63f8&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f12b63f8\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","ref","staticStyle","attrs","on","closeCamera","_v","openCamera","_l","imgSrcList","item","index","key","_s","staticRenderFns","data","stream","recognizeTimer","methods","navigator","mediaDevices","getUserMedia","video","$refs","srcObject","startRecognize","e","$message","error","getTracks","forEach","track","stop","clearInterval","setInterval","recognizeFrame","canvas","document","createElement","width","videoWidth","height","videoHeight","ctx","getContext","drawImage","currentImg","toDataURL","push","console","log","text","Tesseract","beforeDestroy","component"],"sourceRoot":""}