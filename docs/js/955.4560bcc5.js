"use strict";(self["webpackChunkFE_useful_code"]=self["webpackChunkFE_useful_code"]||[]).push([[955],{25955:function(e,t,l){l.r(t),l.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"import-excel"},[t("div",{staticClass:"top"},[t("el-upload",{ref:"upload",attrs:{action:"","auto-upload":!1,multiple:!0,"show-file-list":!1,"on-change":e.handleFileChange,accept:".xlsx,.xls"}},[t("el-button",{attrs:{type:"primary"}},[e._v("选择Excel文件")])],1)],1),t("div",{staticClass:"bottom"},[e.tableData.length?t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"100%"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),e._l(e.tableHeader,(function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e}})}))],2):e._e()],1)])},o=[],r=(l(24224),l(61121),l(37133),l(70560),l(87092)),s={data(){return{tableHeader:[],tableData:[]}},methods:{async handleFileChange(e,t){this.tableHeader=[],this.tableData=[];for(const l of t){const e=l.raw||l;await this.readExcel(e)}},readExcel(e){return new Promise((t=>{const l=new FileReader;l.onload=e=>{const l=new Uint8Array(e.target.result),a=r.ij(l,{type:"array"}),o=a.SheetNames[0],s=a.Sheets[o];console.log("%c读取的sheet:","color: red;"),console.log(s);const n=r.P6.sheet_to_json(s,{header:1});console.log("%c转换后的json:","color: red;"),console.log(n),console.log("%c最长的数组:","color: red;");const c=this.findLongestArray(n);if(console.log(c),n.length){this.tableHeader.length||(this.tableHeader=n[c.index]);let e=n.slice(c.index);for(let t=1;t<e.length;t++){const l={};this.tableHeader.forEach(((a,o)=>{l[a]=e[t][o]||""})),this.tableData.push(l)}}t()},l.readAsArrayBuffer(e)}))},findLongestArray(e){let t=0,l=null,a=-1;for(let o=0;o<20;o++){const r=e[o];r&&r.length>t&&(t=r.length,l=r,a=o)}return{array:l,index:a}}}},n=s,c=l(1001),i=(0,c.Z)(n,a,o,!1,null,"2a2f7006",null),d=i.exports}}]);
//# sourceMappingURL=955.4560bcc5.js.map