"use strict";(self["webpackChunkFE_useful_code"]=self["webpackChunkFE_useful_code"]||[]).push([[34],{6034:function(e,t,l){l.r(t),l.d(t,{default:function(){return m}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"create-form"},[t("h2",[e._v("创建调查问卷")]),t("div",{staticClass:"main"},[t("el-form",{ref:"formTableRef",staticStyle:{height:"100%"},attrs:{model:e.form,rules:e.rules}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.tableData,border:"",height:"100%"}},[t("el-table-column",{attrs:{prop:"txt",label:"问题内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-form-item",{attrs:{prop:`tableData.${l.$index}.txt`,rules:e.rules.txt}},[t("el-input",{attrs:{maxlength:"20",placeholder:"请输入"},model:{value:l.row.txt,callback:function(t){e.$set(l.row,"txt","string"===typeof t?t.trim():t)},expression:"scope.row.txt"}})],1)]}}])}),t("el-table-column",{attrs:{prop:"txtCode",label:"问题编码",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-form-item",{attrs:{prop:`tableData.${l.$index}.txtCode`,rules:e.rules.txtCode}},[t("el-input",{attrs:{placeholder:"请输入",disabled:""},model:{value:l.row.txtCode,callback:function(t){e.$set(l.row,"txtCode","string"===typeof t?t.trim():t)},expression:"scope.row.txtCode"}})],1)]}}])}),t("el-table-column",{attrs:{prop:"type",label:"类型",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-form-item",{attrs:{prop:`tableData.${l.$index}.type`,rules:e.rules.type}},[t("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:l.row.type,callback:function(t){e.$set(l.row,"type",t)},expression:"scope.row.type"}},[t("el-option",{attrs:{label:"填空题",value:"textarea"}}),t("el-option",{attrs:{label:"单选题",value:"radio"}}),t("el-option",{attrs:{label:"多选题",value:"checkbox"}})],1)],1)]}}])}),t("el-table-column",{attrs:{prop:"isRequired",label:"是否必填",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:l.row.isRequired,callback:function(t){e.$set(l.row,"isRequired",t)},expression:"scope.row.isRequired"}})]}}])}),t("el-table-column",{attrs:{prop:"typeOptions",label:"选项配置",align:"center",width:"420"},scopedSlots:e._u([{key:"default",fn:function(l){return["radio"===l.row.type||"checkbox"===l.row.type?[t("SmallTable",{key:`smallTable-${l.$index}`,attrs:{"table-data":l.row.typeOptions}}),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onOptionsAdd(l.$index)}}},[e._v("增加选项")])]:t("span",[e._v("无")])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.onDeleteByItem(l.$index)}}},[e._v("删除")])]}}])})],1)],1),t("el-drawer",{attrs:{title:"预览",visible:e.drawerVisible,size:"500px"},on:{"update:visible":function(t){e.drawerVisible=t}}},[t("div",{staticStyle:{padding:"0 20px"}},[t("el-form",{ref:"reviewFormRef",attrs:{model:e.formConstrator,rules:e.rulesConstrator,"label-position":"top","label-width":"80px"}},[e._l(e.form.tableData,(function(l,r){return[t("el-form-item",{key:r,attrs:{label:l.txt,prop:l.txtCode}},["textarea"===l.type?[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入"},model:{value:e.formConstrator[l.txtCode],callback:function(t){e.$set(e.formConstrator,l.txtCode,t)},expression:"formConstrator[ques.txtCode]"}})]:e._e(),"radio"===l.type?[t("el-radio-group",{model:{value:e.formConstrator[l.txtCode],callback:function(t){e.$set(e.formConstrator,l.txtCode,t)},expression:"formConstrator[ques.txtCode]"}},e._l(l.typeOptions||[],(function(l,r){return t("el-radio",{key:r,attrs:{label:l.value}},[e._v(e._s(l.label))])})),1)]:e._e(),"checkbox"===l.type?[t("el-checkbox-group",{model:{value:e.formConstrator[l.txtCode],callback:function(t){e.$set(e.formConstrator,l.txtCode,t)},expression:"formConstrator[ques.txtCode]"}},e._l(l.typeOptions||[],(function(l,r){return t("el-checkbox",{key:r,attrs:{label:l.value}},[e._v(e._s(l.label))])})),1)]:e._e()],2)]})),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitByTest}},[e._v("校验测试")]),t("el-button",{attrs:{type:"danger"},on:{click:e.onCloseDrawer}},[e._v("关闭")])],1)],2)],1)])],1),t("div",{staticStyle:{width:"100%","text-align":"center",margin:"10px 0"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.onAddByQuestion}},[e._v("新建问题")]),t("el-button",{attrs:{type:"warning"},on:{click:e.onReview}},[e._v("预览")])],1)])},a=[],o=(l(560),function(){var e=this,t=e._self._c;return t("el-form",{ref:"smallTableRef",attrs:{model:e.form}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{prop:"label",label:"选项值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-form-item",{attrs:{prop:`tableData.${l.$index}.label`,rules:e.rules.label}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:l.row.label,callback:function(t){e.$set(l.row,"label","string"===typeof t?t.trim():t)},expression:"scope.row.label"}})],1)]}}])}),t("el-table-column",{attrs:{prop:"value",label:"选项值编码",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-form-item",{attrs:{prop:`tableData.${l.$index}.value`,rules:e.rules.value}},[t("el-input",{attrs:{placeholder:"请输入",disabled:""},model:{value:l.row.value,callback:function(t){e.$set(l.row,"value","string"===typeof t?t.trim():t)},expression:"scope.row.value"}})],1)]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.onDeleteByOptions(l.$index)}}},[e._v("删除")])]}}])})],1)],1)}),s=[],n={name:"smallTable",props:{tableData:{type:Array,default:()=>[]}},data(){return{rules:{label:[{required:!0,message:"请输入选项值",trigger:"blur"}],value:[{required:!0,message:"请输入问题编码",trigger:"blur"}]}}},computed:{form(){return{tableData:this.tableData}}},methods:{onDeleteByOptions(e){this.tableData.splice(e,1),this.$refs["smallTableRef"].clearValidate()}}},i=n,u=l(1001),c=(0,u.Z)(i,o,s,!1,null,"295cdd94",null),p=c.exports,d={name:"createForm",components:{SmallTable:p},data(){return{form:{tableData:[{txt:"问题1",txtCode:"txt1",type:"textarea",isRequired:!1,typeOptions:[]},{txt:"问题2",txtCode:"txt2",type:"radio",isRequired:!0,typeOptions:[{label:"选项1",value:"option1"},{label:"选项2",value:"option2"}]},{txt:"问题3",txtCode:"txt3",type:"checkbox",isRequired:!1,typeOptions:[{label:"选项1",value:"option1"},{label:"选项2",value:"option2"},{label:"选项3",value:"option3"}]}]},rules:{txt:[{required:!0,message:"请输入问题",trigger:"blur"}],txtCode:[{required:!0,message:"请输入问题编码",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}]},formConstrator:{},rulesConstrator:{},drawerVisible:!1}},methods:{onOptionsAdd(e){this.form.tableData[e].typeOptions.push({label:`选项${this.form.tableData[e].typeOptions.length+1}`,value:`option${this.form.tableData[e].typeOptions.length+1}`})},onDeleteByItem(e){this.form.tableData.splice(e,1),this.$refs["formTableRef"].clearValidate()},onAddByQuestion(){const e={txt:`问题${this.form.tableData.length+1}`,txtCode:`txt${this.form.tableData.length+1}`,type:"textarea",isRequired:!1,typeOptions:[]};this.form.tableData.push(e)},onReview(){this.form.tableData.forEach((e=>{this.$set(this.formConstrator,e.txtCode,"checkbox"===e.type?[]:""),this.$set(this.rulesConstrator,e.txtCode,[{required:e.isRequired,message:"请输入或选择",trigger:"blur"}])})),this.drawerVisible=!0},onSubmitByTest(){this.$refs["reviewFormRef"].validate((e=>{if(!e)return this.$message.error("请填写完整"),!1;this.$message.success("校验成功，问卷可提交")}))},onCloseDrawer(){this.drawerVisible=!1}}},b=d,f=(0,u.Z)(b,r,a,!1,null,"1c0fd1cc",null),m=f.exports}}]);
//# sourceMappingURL=34.a2a6a684.js.map