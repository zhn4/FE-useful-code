"use strict";(self["webpackChunkFE_useful_code"]=self["webpackChunkFE_useful_code"]||[]).push([[460],{29460:function(t,e,l){l.r(e),l.d(e,{default:function(){return m}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"create-form"},[e("h2",[t._v("创建调查问卷")]),e("div",{staticClass:"main"},[e("el-form",{ref:"formTableRef",staticStyle:{height:"100%"},attrs:{model:t.form,rules:t.rules}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.tableData,border:"",height:"100%"}},[e("el-table-column",{attrs:{prop:"txt",label:"问题内容",align:"center"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-form-item",{attrs:{prop:`tableData.${l.$index}.txt`,rules:t.rules.txt}},[e("el-input",{attrs:{maxlength:"20",placeholder:"请输入"},model:{value:l.row.txt,callback:function(e){t.$set(l.row,"txt","string"===typeof e?e.trim():e)},expression:"scope.row.txt"}})],1)]}}])}),e("el-table-column",{attrs:{prop:"txtCode",label:"问题编码",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-form-item",{attrs:{prop:`tableData.${l.$index}.txtCode`,rules:t.rules.txtCode}},[e("el-input",{attrs:{placeholder:"请输入",disabled:""},model:{value:l.row.txtCode,callback:function(e){t.$set(l.row,"txtCode","string"===typeof e?e.trim():e)},expression:"scope.row.txtCode"}})],1)]}}])}),e("el-table-column",{attrs:{prop:"type",label:"类型",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-form-item",{attrs:{prop:`tableData.${l.$index}.type`,rules:t.rules.type}},[e("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:l.row.type,callback:function(e){t.$set(l.row,"type",e)},expression:"scope.row.type"}},[e("el-option",{attrs:{label:"填空题",value:"textarea"}}),e("el-option",{attrs:{label:"单选题",value:"radio"}}),e("el-option",{attrs:{label:"多选题",value:"checkbox"}})],1)],1)]}}])}),e("el-table-column",{attrs:{prop:"isRequired",label:"是否必填",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:l.row.isRequired,callback:function(e){t.$set(l.row,"isRequired",e)},expression:"scope.row.isRequired"}})]}}])}),e("el-table-column",{attrs:{prop:"typeOptions",label:"选项配置",align:"center",width:"420"},scopedSlots:t._u([{key:"default",fn:function(l){return["radio"===l.row.type||"checkbox"===l.row.type?[e("SmallTable",{key:`smallTable-${l.$index}`,attrs:{"table-data":l.row.typeOptions}}),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onOptionsAdd(l.$index)}}},[t._v("增加选项")])]:e("span",[t._v("无")])]}}])}),e("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("div",{staticClass:"btns"},[e("el-button",{attrs:{type:"text",icon:"el-icon-top",disabled:0===l.$index},on:{click:function(e){return t.onMoveTopByItem(l.$index)}}},[t._v("上移")]),e("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.onDeleteByItem(l.$index)}}},[t._v("删除")]),e("el-button",{attrs:{type:"text",icon:"el-icon-bottom",disabled:l.$index===t.form.tableData.length-1},on:{click:function(e){return t.onMoveBottomByItem(l.$index)}}},[t._v("下移")])],1)]}}])})],1)],1),e("el-drawer",{attrs:{title:"预览",visible:t.drawerVisible,size:"500px"},on:{"update:visible":function(e){t.drawerVisible=e}}},[e("div",{staticStyle:{padding:"0 20px"}},[e("el-form",{ref:"reviewFormRef",attrs:{model:t.formConstrator,rules:t.rulesConstrator,"label-position":"top","label-width":"80px"}},[t._l(t.form.tableData,(function(l,o){return[e("el-form-item",{key:o,attrs:{label:l.txt,prop:l.txtCode}},["textarea"===l.type?[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入"},model:{value:t.formConstrator[l.txtCode],callback:function(e){t.$set(t.formConstrator,l.txtCode,e)},expression:"formConstrator[ques.txtCode]"}})]:t._e(),"radio"===l.type?[e("el-radio-group",{model:{value:t.formConstrator[l.txtCode],callback:function(e){t.$set(t.formConstrator,l.txtCode,e)},expression:"formConstrator[ques.txtCode]"}},t._l(l.typeOptions||[],(function(l,o){return e("el-radio",{key:o,attrs:{label:l.value}},[t._v(t._s(l.label))])})),1)]:t._e(),"checkbox"===l.type?[e("el-checkbox-group",{model:{value:t.formConstrator[l.txtCode],callback:function(e){t.$set(t.formConstrator,l.txtCode,e)},expression:"formConstrator[ques.txtCode]"}},t._l(l.typeOptions||[],(function(l,o){return e("el-checkbox",{key:o,attrs:{label:l.value}},[t._v(t._s(l.label))])})),1)]:t._e()],2)]})),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitByTest}},[t._v("校验测试")]),e("el-button",{attrs:{type:"danger"},on:{click:t.onCloseDrawer}},[t._v("关闭")])],1)],2)],1)])],1),e("div",{staticStyle:{width:"100%","text-align":"center",margin:"10px 0"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.onAddByQuestion}},[t._v("新建问题")]),e("el-button",{attrs:{type:"warning"},on:{click:t.onReview}},[t._v("预览")])],1)])},a=[],r=(l(70560),function(){var t=this,e=t._self._c;return e("el-form",{ref:"smallTableRef",attrs:{model:t.form}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{prop:"label",label:"选项值",align:"center"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-form-item",{attrs:{prop:`tableData.${l.$index}.label`,rules:t.rules.label}},[e("el-input",{attrs:{placeholder:"请输入"},model:{value:l.row.label,callback:function(e){t.$set(l.row,"label","string"===typeof e?e.trim():e)},expression:"scope.row.label"}})],1)]}}])}),e("el-table-column",{attrs:{prop:"value",label:"选项值编码",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-form-item",{attrs:{prop:`tableData.${l.$index}.value`,rules:t.rules.value}},[e("el-input",{attrs:{placeholder:"请输入",disabled:""},model:{value:l.row.value,callback:function(e){t.$set(l.row,"value","string"===typeof e?e.trim():e)},expression:"scope.row.value"}})],1)]}}])}),e("el-table-column",{attrs:{label:"操作",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(e){return t.onDeleteByOptions(l.$index)}}},[t._v("删除")]),e("el-button",{attrs:{type:"text",disabled:0===l.$index},on:{click:function(e){return t.onMoveTopByItem(l.$index)}}},[t._v("上移")]),e("el-button",{attrs:{type:"text",disabled:l.$index===t.form.tableData.length-1},on:{click:function(e){return t.onMoveBottomByItem(l.$index)}}},[t._v("下移")])]}}])})],1)],1)}),s=[],i={name:"smallTable",props:{tableData:{type:Array,default:()=>[]}},data(){return{rules:{label:[{required:!0,message:"请输入选项值",trigger:"blur"}],value:[{required:!0,message:"请输入问题编码",trigger:"blur"}]}}},computed:{form(){return{tableData:this.tableData}}},methods:{onDeleteByOptions(t){this.tableData.splice(t,1),this.$refs["smallTableRef"].clearValidate()},onMoveTopByItem(t){if(t>0){const e=this.form.tableData[t];this.form.tableData.splice(t,1),this.form.tableData.splice(t-1,0,e)}},onMoveBottomByItem(t){if(t<this.form.tableData.length-1){const e=this.form.tableData[t];this.form.tableData.splice(t,1),this.form.tableData.splice(t+1,0,e)}}}},n=i,u=l(1001),c=(0,u.Z)(n,r,s,!1,null,"6e984270",null),p=c.exports,d={name:"createForm",components:{SmallTable:p},data(){return{form:{tableData:[{txt:"问题1",txtCode:"txt1",type:"textarea",isRequired:!1,typeOptions:[]},{txt:"问题2",txtCode:"txt2",type:"radio",isRequired:!0,typeOptions:[{label:"选项1",value:"option1"},{label:"选项2",value:"option2"}]},{txt:"问题3",txtCode:"txt3",type:"checkbox",isRequired:!1,typeOptions:[{label:"选项1",value:"option1"},{label:"选项2",value:"option2"},{label:"选项3",value:"option3"}]}]},rules:{txt:[{required:!0,message:"请输入问题",trigger:"blur"}],txtCode:[{required:!0,message:"请输入问题编码",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}]},formConstrator:{},rulesConstrator:{},drawerVisible:!1}},methods:{onOptionsAdd(t){this.form.tableData[t].typeOptions.push({label:`选项${this.form.tableData[t].typeOptions.length+1}`,value:`option${this.form.tableData[t].typeOptions.length+1}`})},onDeleteByItem(t){this.form.tableData.splice(t,1),this.$refs["formTableRef"].clearValidate()},onAddByQuestion(){const t={txt:`问题${this.form.tableData.length+1}`,txtCode:`txt${this.form.tableData.length+1}`,type:"textarea",isRequired:!1,typeOptions:[]};this.form.tableData.push(t)},onReview(){this.form.tableData.forEach((t=>{this.$set(this.formConstrator,t.txtCode,"checkbox"===t.type?[]:""),this.$set(this.rulesConstrator,t.txtCode,[{required:t.isRequired,message:"请输入或选择",trigger:"blur"}])})),this.drawerVisible=!0},onSubmitByTest(){this.$refs["reviewFormRef"].validate((t=>{if(!t)return this.$message.error("请填写完整"),!1;this.$message.success("校验成功，问卷可提交")}))},onCloseDrawer(){this.drawerVisible=!1},onMoveTopByItem(t){if(t>0){const e=this.form.tableData[t];this.form.tableData.splice(t,1),this.form.tableData.splice(t-1,0,e)}},onMoveBottomByItem(t){if(t<this.form.tableData.length-1){const e=this.form.tableData[t];this.form.tableData.splice(t,1),this.form.tableData.splice(t+1,0,e)}}}},b=d,f=(0,u.Z)(b,o,a,!1,null,"7c99ed18",null),m=f.exports}}]);
//# sourceMappingURL=460.16e220e0.js.map